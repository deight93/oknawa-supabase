# oknawa-supabase

## 최종 구현 대상 엔드포인트 목록

---

중간지점 추천 관련

1. 중간지점 추천받기 ✅

2. 추천받기 결과 조회 (Polling) ✅

3. 선호도 투표 ✅

4. 선호도 투표 확정 ✅

---

결과확정 및 핫플레이스 관련

5. 중간지점 결과(share_key)로 조회 ✅

6. 결과확정페이지에서 핫플레이스(만날장소) 리스트 ✅

---

함께 입력 기능(동시 위치 입력) 관련
7. 호스트 출발지 입력 및 공간 생성 ✅

8. 함께 입력방 현황 조회 (Polling) ✅

9. 클라이언트 출발지 입력  ✅

10. 호스트/클라이언트 출발지 수정 ✅

---

부가 기능(주요 지하철역 upsert 등)

11. 주요 지하철역 데이터 upsert ✅



---

## TODO: 중간지점 추천 알고리즘 개선

* [ ] **이동 시간 기반 추천**

    * 참여자별 출발지 → 각 후보 지하철역까지 대중교통 이동시간 계산
    * 모든 참여자의 이동시간 총합이 최소인 역을 1순위로 추천
    * Kakao/네이버/Google Directions API 활용

* [ ] **가중치 중앙값 기반 추천**

    * 참여자 좌표의 위도/경도 중앙값 계산
    * 해당 좌표와 가장 가까운 후보역 추천
    * outlier(멀리서 오는 사람) 영향 최소화

* [ ] **최대 이동 거리 최소화 (minimax)**

    * 각 후보역별로, 참여자 중 ‘가장 멀리서 오는 사람’의 이동거리(또는 시간) 계산
    * 이 값이 최소인 역을 추천

* [ ] **유동인구 및 편의성 가중치 적용**

    * 유동인구 순위/역세권/편의시설 등 역 자체 가중치 반영
    * 최종 후보 Top3 중에서 추가 점수 적용

* [ ] **환승/교통 편의성 반영**

    * 각 역별 환승 횟수, 지하철/버스만으로 접근 가능 여부 등 분석
    * 환승 최소, 대중교통 이용이 쉬운 역 우선 추천

* [ ] **요일/시간대별 실시간 교통 데이터 반영**

    * 출발 시간대/요일에 따라 교통 소요시간 반영(실제 출근/퇴근/심야 등)
    * API 데이터 활용 자동화

* [ ] **추천 결과 상세 제공**

    * Top 3 역 + 각 참여자별 예상 이동시간, 이동경로, 환승정보 등 표기
    * 결과 UI/UX 개선


---

### **정리**

* **가장 추천하는 것은 “모든 참여자의 이동 소요 시간 합산이 최소가 되는 역”을 추천하는 방식**
* 대중교통 API(카카오, 네이버, 구글 Directions)로 소요시간 조회 자동화.

---

### **실제 구현 흐름 예시**

1. 유동인구 Top80 역 리스트 확보
2. 각 참여자별 출발 좌표 → 80개 역의 대중교통 소요시간/거리 계산
3. 역별로 전체 참여자의 이동시간 총합, 최대값, 중앙값 등을 계산
4. 1. 이동시간 합 최소, 2) 최대값 최소, 3) 유동인구/환승가중치 적용 등 조합
5. Top1\~3개 역 + 상세 이동경로/예상 소요시간 표기
